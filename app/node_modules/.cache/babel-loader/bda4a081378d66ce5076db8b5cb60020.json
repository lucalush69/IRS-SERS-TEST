{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.BidRedemptionTicket = exports.WINNER_INDEX_OFFSETS = void 0;\n\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\n\nconst bs58_1 = __importDefault(require(\"bs58\"));\n\nconst MetaplexProgram_1 = require(\"../MetaplexProgram\");\n\nconst mpl_core_1 = require(\"@metaplex-foundation/mpl-core\");\n\nexports.WINNER_INDEX_OFFSETS = [2, 10];\n\nclass BidRedemptionTicket extends mpl_core_1.Account {\n  constructor(pubkey, info) {\n    super(pubkey, info);\n\n    if (!this.assertOwner(MetaplexProgram_1.MetaplexProgram.PUBKEY)) {\n      throw (0, mpl_core_1.ERROR_INVALID_OWNER)();\n    }\n\n    if (BidRedemptionTicket.isBidRedemptionTicketV1(this.info.data)) {\n      throw (0, mpl_core_1.ERROR_DEPRECATED_ACCOUNT_DATA)();\n    } else if (BidRedemptionTicket.isBidRedemptionTicketV2(this.info.data)) {\n      const data = this.info.data.toJSON().data;\n      const winnerIndex = data[1] !== 0 && new bn_js_1.default(data.slice(1, 9), 'le');\n      const offset = exports.WINNER_INDEX_OFFSETS[+!!winnerIndex];\n      this.data = {\n        key: MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV2,\n        winnerIndex,\n        data,\n        auctionManager: bs58_1.default.encode(data.slice(offset, offset + 32))\n      };\n    } else {\n      throw (0, mpl_core_1.ERROR_INVALID_ACCOUNT_DATA)();\n    }\n  }\n\n  static isCompatible(data) {\n    return BidRedemptionTicket.isBidRedemptionTicketV1(data) || BidRedemptionTicket.isBidRedemptionTicketV2(data);\n  }\n\n  static isBidRedemptionTicketV1(data) {\n    return data[0] === MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV1;\n  }\n\n  static isBidRedemptionTicketV2(data) {\n    return data[0] === MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV2;\n  }\n\n}\n\nexports.BidRedemptionTicket = BidRedemptionTicket;","map":{"version":3,"sources":["../../../src/accounts/BidRedemptionTicket.ts"],"names":[],"mappings":";;;;;;;;;;;;;AACA,MAAA,OAAA,GAAA,eAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AACA,MAAA,MAAA,GAAA,eAAA,CAAA,OAAA,CAAA,MAAA,CAAA,CAAA;;AACA,MAAA,iBAAA,GAAA,OAAA,CAAA,oBAAA,CAAA;;AACA,MAAA,UAAA,GAAA,OAAA,CAAA,+BAAA,CAAA;;AAiBa,OAAA,CAAA,oBAAA,GAAuB,CAAC,CAAD,EAAI,EAAJ,CAAvB;;AAEb,MAAa,mBAAb,SAAyC,UAAA,CAAA,OAAzC,CAA2E;AACzE,EAAA,WAAA,CAAY,MAAZ,EAAkC,IAAlC,EAA2D;AACzD,UAAM,MAAN,EAAc,IAAd;;AAEA,QAAI,CAAC,KAAK,WAAL,CAAiB,iBAAA,CAAA,eAAA,CAAgB,MAAjC,CAAL,EAA+C;AAC7C,YAAM,CAAA,GAAA,UAAA,CAAA,mBAAA,GAAN;AACD;;AAED,QAAI,mBAAmB,CAAC,uBAApB,CAA4C,KAAK,IAAL,CAAU,IAAtD,CAAJ,EAAiE;AAC/D,YAAM,CAAA,GAAA,UAAA,CAAA,6BAAA,GAAN;AACD,KAFD,MAEO,IAAI,mBAAmB,CAAC,uBAApB,CAA4C,KAAK,IAAL,CAAU,IAAtD,CAAJ,EAAiE;AACtE,YAAM,IAAI,GAAG,KAAK,IAAL,CAAU,IAAV,CAAe,MAAf,GAAwB,IAArC;AAEA,YAAM,WAAW,GAAG,IAAI,CAAC,CAAD,CAAJ,KAAY,CAAZ,IAAiB,IAAI,OAAA,CAAA,OAAJ,CAAO,IAAI,CAAC,KAAL,CAAW,CAAX,EAAc,CAAd,CAAP,EAAyB,IAAzB,CAArC;AACA,YAAM,MAAM,GAAG,OAAA,CAAA,oBAAA,CAAqB,CAAC,CAAC,CAAC,WAAxB,CAAf;AAEA,WAAK,IAAL,GAAY;AACV,QAAA,GAAG,EAAE,iBAAA,CAAA,WAAA,CAAY,qBADP;AAEV,QAAA,WAFU;AAGV,QAAA,IAHU;AAIV,QAAA,cAAc,EAAE,MAAA,CAAA,OAAA,CAAK,MAAL,CAAY,IAAI,CAAC,KAAL,CAAW,MAAX,EAAmB,MAAM,GAAG,EAA5B,CAAZ;AAJN,OAAZ;AAMD,KAZM,MAYA;AACL,YAAM,CAAA,GAAA,UAAA,CAAA,0BAAA,GAAN;AACD;AACF;;AAEkB,SAAZ,YAAY,CAAC,IAAD,EAAa;AAC9B,WACE,mBAAmB,CAAC,uBAApB,CAA4C,IAA5C,KACA,mBAAmB,CAAC,uBAApB,CAA4C,IAA5C,CAFF;AAID;;AAE6B,SAAvB,uBAAuB,CAAC,IAAD,EAAa;AACzC,WAAO,IAAI,CAAC,CAAD,CAAJ,KAAY,iBAAA,CAAA,WAAA,CAAY,qBAA/B;AACD;;AAE6B,SAAvB,uBAAuB,CAAC,IAAD,EAAa;AACzC,WAAO,IAAI,CAAC,CAAD,CAAJ,KAAY,iBAAA,CAAA,WAAA,CAAY,qBAA/B;AACD;;AAxCwE;;AAA3E,OAAA,CAAA,mBAAA,GAAA,mBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BidRedemptionTicket = exports.WINNER_INDEX_OFFSETS = void 0;\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\nconst bs58_1 = __importDefault(require(\"bs58\"));\nconst MetaplexProgram_1 = require(\"../MetaplexProgram\");\nconst mpl_core_1 = require(\"@metaplex-foundation/mpl-core\");\nexports.WINNER_INDEX_OFFSETS = [2, 10];\nclass BidRedemptionTicket extends mpl_core_1.Account {\n    constructor(pubkey, info) {\n        super(pubkey, info);\n        if (!this.assertOwner(MetaplexProgram_1.MetaplexProgram.PUBKEY)) {\n            throw (0, mpl_core_1.ERROR_INVALID_OWNER)();\n        }\n        if (BidRedemptionTicket.isBidRedemptionTicketV1(this.info.data)) {\n            throw (0, mpl_core_1.ERROR_DEPRECATED_ACCOUNT_DATA)();\n        }\n        else if (BidRedemptionTicket.isBidRedemptionTicketV2(this.info.data)) {\n            const data = this.info.data.toJSON().data;\n            const winnerIndex = data[1] !== 0 && new bn_js_1.default(data.slice(1, 9), 'le');\n            const offset = exports.WINNER_INDEX_OFFSETS[+!!winnerIndex];\n            this.data = {\n                key: MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV2,\n                winnerIndex,\n                data,\n                auctionManager: bs58_1.default.encode(data.slice(offset, offset + 32)),\n            };\n        }\n        else {\n            throw (0, mpl_core_1.ERROR_INVALID_ACCOUNT_DATA)();\n        }\n    }\n    static isCompatible(data) {\n        return (BidRedemptionTicket.isBidRedemptionTicketV1(data) ||\n            BidRedemptionTicket.isBidRedemptionTicketV2(data));\n    }\n    static isBidRedemptionTicketV1(data) {\n        return data[0] === MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV1;\n    }\n    static isBidRedemptionTicketV2(data) {\n        return data[0] === MetaplexProgram_1.MetaplexKey.BidRedemptionTicketV2;\n    }\n}\nexports.BidRedemptionTicket = BidRedemptionTicket;\n//# sourceMappingURL=BidRedemptionTicket.js.map"]},"metadata":{},"sourceType":"script"}